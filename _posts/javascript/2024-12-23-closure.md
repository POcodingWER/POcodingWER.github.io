---
layout: post
title: "[JS] í´ë¡œì €(Closure)"

subtitle: "javaScript ê¸°ì´ˆë¥¼ íƒ„íƒ„í•˜ê²Œ ë‹¤ì ¸ë³´ì"

date: 2024-12-23 13:15:17
# lastmod: 2024-08-14 10:10:00
author: "lim.Chuck"

# header-style: text

catalog: true
header-mask: 0.4
header-img: "img/post/2024/1206/js.png"
#
# sitemap:
#   changefreq: daily #ìŠ¤í¬ë© ì£¼ê¸°  daily | weekly | monthly
#   priority: 1.0  # ìŠ¤í¬ë© ìš°ì„ ìˆœìœ„
# hidden: true
categories:
  - JavaScript
tags:
  - js ê¸°ì´ˆ
  - js ë¬¸ë²•
  - js ê¸°ì´ˆ ë¬¸ë²•
  - js closure
---

{% include post/js_contents.md %}

í´ë¡œì €! í•¨ìˆ˜ì™€ ê·¸ í•¨ìˆ˜ê°€ ì„ ì–¸ëœ ë ‰ì‹œì»¬ í™˜ê²½ì˜ ì¡°í•©ì´ì•¼! ğŸ¯

### 1. í´ë¡œì € ê¸°ë³¸ ê°œë…

```javascript
// ê¸°ë³¸ì ì¸ í´ë¡œì €
function createCounter() {
  let count = 0; // ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€ëŠ¥í•œ ë³€ìˆ˜

  return {
    increase() {
      return ++count;
    },
    decrease() {
      return --count;
    },
    getCount() {
      return count;
    },
  };
}

const counter = createCounter();
console.log(counter.increase()); // 1
console.log(counter.increase()); // 2
console.log(counter.decrease()); // 1
console.log(counter.getCount()); // 1

// count ë³€ìˆ˜ì— ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€
console.log(counter.count); // undefined
```

### 2. í´ë¡œì €ë¥¼ í™œìš©í•œ í”„ë¼ì´ë¹— ë³€ìˆ˜

```javascript
function createWallet(initialBalance) {
  let balance = initialBalance; // í”„ë¼ì´ë¹— ë³€ìˆ˜

  return {
    deposit(amount) {
      if (amount > 0) {
        balance += amount;
        return `${amount}ì›ì´ ì…ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤. ì”ì•¡: ${balance}ì›`;
      }
      return "ìœ íš¨í•˜ì§€ ì•Šì€ ì…ê¸ˆì•¡ì…ë‹ˆë‹¤.";
    },

    withdraw(amount) {
      if (amount > 0 && balance >= amount) {
        balance -= amount;
        return `${amount}ì›ì´ ì¶œê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤. ì”ì•¡: ${balance}ì›`;
      }
      return "ì¶œê¸ˆì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.";
    },

    getBalance() {
      return `í˜„ì¬ ì”ì•¡: ${balance}ì›`;
    },
  };
}

const myWallet = createWallet(1000);
console.log(myWallet.deposit(500)); // "500ì›ì´ ì…ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤. ì”ì•¡: 1500ì›"
console.log(myWallet.withdraw(200)); // "200ì›ì´ ì¶œê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤. ì”ì•¡: 1300ì›"
console.log(myWallet.getBalance()); // "í˜„ì¬ ì”ì•¡: 1300ì›"
```

### 3. í´ë¡œì €ë¥¼ ì´ìš©í•œ ëª¨ë“ˆ íŒ¨í„´

```javascript
const userModule = (function () {
  // í”„ë¼ì´ë¹— ë³€ìˆ˜
  let users = [];

  // í”„ë¼ì´ë¹— í•¨ìˆ˜
  function validateUser(user) {
    return user.name && user.age;
  }

  // í¼ë¸”ë¦­ API
  return {
    addUser(user) {
      if (validateUser(user)) {
        users.push(user);
        return "ì‚¬ìš©ìê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.";
      }
      return "ìœ íš¨í•˜ì§€ ì•Šì€ ì‚¬ìš©ìì…ë‹ˆë‹¤.";
    },

    getUsers() {
      return [...users]; // ë°°ì—´ì˜ ë³µì‚¬ë³¸ ë°˜í™˜
    },

    findUser(name) {
      return users.find((user) => user.name === name);
    },
  };
})();

userModule.addUser({ name: "ê¹€ì½”ë”©", age: 20 });
console.log(userModule.getUsers()); // [{name: "ê¹€ì½”ë”©", age: 20}]
console.log(userModule.users); // undefined (í”„ë¼ì´ë¹—)
```

### 4. í´ë¡œì €ì™€ ì»¤ë§

```javascript
function multiply(a) {
  return function (b) {
    return function (c) {
      return a * b * c;
    };
  };
}

// ì»¤ë§ëœ í•¨ìˆ˜ ì‚¬ìš©
const mult2 = multiply(2); // a = 2ë¡œ ê³ ì •
const mult2_3 = mult2(3); // b = 3ìœ¼ë¡œ ê³ ì •
console.log(mult2_3(4)); // 2 * 3 * 4 = 24

// í•œ ë²ˆì— í˜¸ì¶œ
console.log(multiply(2)(3)(4)); // 24

// ì‹¤ìš©ì ì¸ ì˜ˆì œ
function formatPrice(currency) {
  return function (price) {
    return `${currency}${price.toFixed(2)}`;
  };
}

const formatUSD = formatPrice("$");
const formatKRW = formatPrice("â‚©");

console.log(formatUSD(123.456)); // "$123.46"
console.log(formatKRW(1000)); // "â‚©1000.00"
```

### 5. í´ë¡œì €ì™€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬

```javascript
function createButtonCounter() {
  let count = 0;

  function updateDisplay() {
    console.log(`í´ë¦­ íšŸìˆ˜: ${count}`);
  }

  return function handleClick() {
    count++;
    updateDisplay();
  };
}

// DOM ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆì—ì„œ ì‚¬ìš©
const button = document.createElement("button");
button.textContent = "í´ë¦­í•˜ì„¸ìš”";
button.addEventListener("click", createButtonCounter());
```

### 6. í´ë¡œì €ë¥¼ í™œìš©í•œ ë©”ëª¨ì´ì œì´ì…˜

```javascript
function memoize(fn) {
  const cache = new Map();

  return function (...args) {
    const key = JSON.stringify(args);

    if (cache.has(key)) {
      console.log("ìºì‹œëœ ê²°ê³¼ ì‚¬ìš©");
      return cache.get(key);
    }

    const result = fn.apply(this, args);
    cache.set(key, result);
    console.log("ìƒˆë¡œìš´ ê²°ê³¼ ê³„ì‚°");
    return result;
  };
}

// í”¼ë³´ë‚˜ì¹˜ ìˆ˜ì—´ ê³„ì‚°
const fibonacci = memoize(function (n) {
  if (n < 2) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
});

console.log(fibonacci(10)); // ì²˜ìŒ ê³„ì‚°
console.log(fibonacci(10)); // ìºì‹œëœ ê²°ê³¼
```

### ê¿€íŒ! ğŸ¯

1. ë©”ëª¨ë¦¬ ê´€ë¦¬

```javascript
// BAD: ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ê°€ëŠ¥ì„±
function createBadClosure() {
  const largeData = new Array(1000000);
  return function () {
    console.log(largeData.length);
  };
}

// GOOD: í•„ìš”í•œ ë°ì´í„°ë§Œ ìœ ì§€
function createGoodClosure() {
  const largeData = new Array(1000000);
  const dataLength = largeData.length;
  return function () {
    console.log(dataLength);
  };
}
```

2. ì„±ëŠ¥ ìµœì í™”

```javascript
// í´ë¡œì € ì¬ì‚¬ìš©
const createLogger = (prefix) => {
  // í´ë¡œì €ëŠ” í•œ ë²ˆë§Œ ìƒì„±
  const logger = (message) => {
    console.log(`${prefix}: ${message}`);
  };

  return logger;
};

const debugLog = createLogger("DEBUG");
const errorLog = createLogger("ERROR");

debugLog("í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€"); // "DEBUG: í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€"
errorLog("ì˜¤ë¥˜ ë°œìƒ!"); // "ERROR: ì˜¤ë¥˜ ë°œìƒ!"
```

ì´ì œ í´ë¡œì €ëŠ” ë§ˆìŠ¤í„°! ğŸ˜
í”„ë¼ì´ë¹— ë³€ìˆ˜ ê´€ë¦¬ì™€ ìƒíƒœ ìœ ì§€ê°€ í•„ìš”í•œ ìƒí™©ì—ì„œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´!
