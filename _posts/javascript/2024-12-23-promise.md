---
layout: post
title: "[JS] í”„ë¡œë¯¸ìŠ¤(Promise)"

subtitle: "javaScript ê¸°ì´ˆë¥¼ íƒ„íƒ„í•˜ê²Œ ë‹¤ì ¸ë³´ì"

date: 2024-12-23 13:46:00
# lastmod: 2024-08-14 10:10:00
author: "lim.Chuck"

# header-style: text

catalog: true
header-mask: 0.4
header-img: "img/post/2024/1206/js.png"
#
# sitemap:
#   changefreq: daily #ìŠ¤í¬ë© ì£¼ê¸°  daily | weekly | monthly
#   priority: 1.0  # ìŠ¤í¬ë© ìš°ì„ ìˆœìœ„
# hidden: true
categories:
  - JavaScript
tags:
  - js ê¸°ì´ˆ
  - js ë¬¸ë²•
  - js ê¸°ì´ˆ ë¬¸ë²•
  - js promise
---

{% include post/js_contents.md %}

PromiseëŠ” ë¹„ë™ê¸° ì‘ì—…ì„ ë” ì‰½ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê°ì²´ì•¼! ğŸ¯

### 1. Promise ê¸°ë³¸

```javascript
// Promise ìƒì„±
const promise = new Promise((resolve, reject) => {
  // ë¹„ë™ê¸° ì‘ì—… ìˆ˜í–‰
  const success = true;

  if (success) {
    resolve("ì„±ê³µ!"); // ì„±ê³µ ì‹œ
  } else {
    reject("ì‹¤íŒ¨!"); // ì‹¤íŒ¨ ì‹œ
  }
});

// Promise ì‚¬ìš©
promise
  .then((result) => {
    console.log(result); // "ì„±ê³µ!"
  })
  .catch((error) => {
    console.log(error); // "ì‹¤íŒ¨!"
  })
  .finally(() => {
    console.log("ì™„ë£Œ!"); // ì„±ê³µ/ì‹¤íŒ¨ ìƒê´€ì—†ì´ ì‹¤í–‰
  });
```

### 2. ì‹¤ì œ ì‚¬ìš© ì˜ˆì œ

```javascript
// API í˜¸ì¶œ í•¨ìˆ˜
function fetchUser(id) {
  return new Promise((resolve, reject) => {
    // API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜
    setTimeout(() => {
      const user = {
        id: id,
        name: "ê¹€ì½”ë”©",
        email: "kim@coding.com",
      };

      if (id <= 0) {
        reject(new Error("ì˜ëª»ëœ ID"));
        return;
      }

      resolve(user);
    }, 1000);
  });
}

// ì‚¬ìš©
fetchUser(1)
  .then((user) => {
    console.log("ì‚¬ìš©ì:", user);
    return fetchUser(2); // ì²´ì´ë‹
  })
  .then((user2) => {
    console.log("ì‚¬ìš©ì2:", user2);
  })
  .catch((error) => {
    console.error("ì—ëŸ¬:", error);
  });
```

### 3. Promise.allê³¼ Promise.race

```javascript
// ì—¬ëŸ¬ Promise ë™ì‹œ ì²˜ë¦¬
const promise1 = fetchUser(1);
const promise2 = fetchUser(2);
const promise3 = fetchUser(3);

// ëª¨ë“  Promiseê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
Promise.all([promise1, promise2, promise3])
  .then((users) => {
    console.log("ëª¨ë“  ì‚¬ìš©ì:", users);
  })
  .catch((error) => {
    console.error("í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨:", error);
  });

// ê°€ì¥ ë¨¼ì € ì™„ë£Œë˜ëŠ” Promise ê²°ê³¼ ë°˜í™˜
Promise.race([promise1, promise2, promise3]).then((firstUser) => {
  console.log("ì²«ë²ˆì§¸ ì™„ë£Œ:", firstUser);
});
```

### 4. async/await ì‚¬ìš©

```javascript
// async/awaitë¡œ ë” ê¹”ë”í•˜ê²Œ ì²˜ë¦¬
async function getUsers() {
  try {
    const user1 = await fetchUser(1);
    console.log("ì‚¬ìš©ì1:", user1);

    const user2 = await fetchUser(2);
    console.log("ì‚¬ìš©ì2:", user2);

    return [user1, user2];
  } catch (error) {
    console.error("ì—ëŸ¬ ë°œìƒ:", error);
    throw error;
  }
}

// ë³‘ë ¬ ì²˜ë¦¬
async function getUsersParallel() {
  try {
    const users = await Promise.all([fetchUser(1), fetchUser(2), fetchUser(3)]);

    console.log("ëª¨ë“  ì‚¬ìš©ì:", users);
    return users;
  } catch (error) {
    console.error("ì—ëŸ¬ ë°œìƒ:", error);
    throw error;
  }
}
```

### 5. ì‹¤ì „ í™œìš©: API í´ë˜ìŠ¤

```javascript
class API {
  constructor(baseURL) {
    this.baseURL = baseURL;
  }

  async get(endpoint) {
    try {
      const response = await fetch(this.baseURL + endpoint);

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      return await response.json();
    } catch (error) {
      console.error("API í˜¸ì¶œ ì‹¤íŒ¨:", error);
      throw error;
    }
  }

  async post(endpoint, data) {
    try {
      const response = await fetch(this.baseURL + endpoint, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      });

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      return await response.json();
    } catch (error) {
      console.error("API í˜¸ì¶œ ì‹¤íŒ¨:", error);
      throw error;
    }
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const api = new API("https://api.example.com");

async function getUserData() {
  try {
    const user = await api.get("/users/1");
    const posts = await api.get(`/users/${user.id}/posts`);

    return { user, posts };
  } catch (error) {
    console.error("ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:", error);
    throw error;
  }
}
```

### 6. Promise ìƒíƒœ

```javascript
const checkPromiseState = (promise) => {
  let state = "pending";

  promise
    .then(() => {
      state = "fulfilled";
      console.log("ìƒíƒœ:", state);
    })
    .catch(() => {
      state = "rejected";
      console.log("ìƒíƒœ:", state);
    });

  console.log("ì´ˆê¸° ìƒíƒœ:", state);
  return state;
};

// Promise ìƒíƒœ í™•ì¸
const promise = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve("ì™„ë£Œ!");
  }, 2000);
});

checkPromiseState(promise); // "pending" -> "fulfilled"
```

### ê¿€íŒ! ğŸ¯

1. Promise.allSettled ì‚¬ìš©

```javascript
// ëª¨ë“  Promiseì˜ ê²°ê³¼ë¥¼ ë°›ìŒ (ì„±ê³µ/ì‹¤íŒ¨ ëª¨ë‘)
Promise.allSettled([
  Promise.resolve(1),
  Promise.reject("ì—ëŸ¬"),
  Promise.resolve(3),
]).then((results) => {
  results.forEach((result) => {
    if (result.status === "fulfilled") {
      console.log("ì„±ê³µ:", result.value);
    } else {
      console.log("ì‹¤íŒ¨:", result.reason);
    }
  });
});
```

2. íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬

```javascript
function withTimeout(promise, timeout) {
  const timeoutPromise = new Promise((_, reject) => {
    setTimeout(() => {
      reject(new Error("ì‹œê°„ ì´ˆê³¼!"));
    }, timeout);
  });

  return Promise.race([promise, timeoutPromise]);
}

// ì‚¬ìš© ì˜ˆì‹œ
withTimeout(fetchUser(1), 5000)
  .then((user) => console.log(user))
  .catch((error) => console.error(error));
```

ì´ì œ PromiseëŠ” ë§ˆìŠ¤í„°! ğŸ˜
ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ì„ ììœ ìì¬ë¡œ í•  ìˆ˜ ìˆì„ ê±°ì•¼!
